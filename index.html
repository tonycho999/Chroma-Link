<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Chroma Link - Advanced Logic Puzzle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --cell-size: 60px; }
        .grid-wrapper { display: grid; grid-template-columns: 40px repeat(5, var(--cell-size)) 40px; gap: 4px; }
        .cell { width: var(--cell-size); height: var(--cell-size); background: #222; position: relative; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 4px; border: 1px solid #333; }
        .hint { width: 40px; height: 60px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; }
        .mirror-slash { width: 80%; height: 4px; background: #aaa; transform: rotate(-45deg); border-radius: 2px; box-shadow: 0 0 8px white; }
        .mirror-backslash { width: 80%; height: 4px; background: #aaa; transform: rotate(45deg); border-radius: 2px; box-shadow: 0 0 8px white; }
        /* 빛의 빔 시각화 */
        .beam-h { position: absolute; width: 100%; height: 4px; opacity: 0.6; z-index: 1; pointer-events: none; }
        .beam-v { position: absolute; width: 4px; height: 100%; opacity: 0.6; z-index: 1; pointer-events: none; }
    </style>
</head>
<body class="bg-zinc-950 text-white min-h-screen flex flex-col items-center py-10">

    <div class="mb-6 text-center">
        <h1 class="text-3xl font-black mb-2 text-indigo-400">CHROMA LINK: EXPERT</h1>
        <p class="text-zinc-500 text-sm italic">"거울로 빛을 굴절시켜 외곽의 타겟 색상을 맞추세요."</p>
    </div>

    <div id="game-board" class="grid-wrapper bg-zinc-900 p-6 rounded-2xl shadow-2xl border border-zinc-800">
        </div>

    <div class="mt-8 flex gap-4">
        <button onclick="changeTool('R')" class="px-4 py-2 bg-red-600 rounded-lg font-bold">R 광원</button>
        <button onclick="changeTool('G')" class="px-4 py-2 bg-green-600 rounded-lg font-bold">G 광원</button>
        <button onclick="changeTool('B')" class="px-4 py-2 bg-blue-600 rounded-lg font-bold">B 광원</button>
        <button onclick="changeTool('M1')" class="px-4 py-2 bg-zinc-500 rounded-lg font-bold">거울(/)</button>
        <button onclick="changeTool('M2')" class="px-4 py-2 bg-zinc-500 rounded-lg font-bold">거울(\)</button>
        <button onclick="resetBoard()" class="px-4 py-2 border border-zinc-700 rounded-lg">초기화</button>
    </div>

    <script>
        const SIZE = 5;
        let currentTool = 'R';
        let grid = Array.from({ length: SIZE }, () => Array(SIZE).fill(null));
        // 외곽 타겟 (예시: 오른쪽 2번째 칸에 보라색을 만들어야 함)
        const targets = { right: [null, 'magenta', null, 'yellow', null] };

        function changeTool(tool) { currentTool = tool; }

        function init() {
            const board = document.getElementById('game-board');
            board.innerHTML = '';
            
            // 상단 빈칸 + 본체 + 하단 빈칸 로직 (간소화)
            for(let r = -1; r <= SIZE; r++) {
                for(let c = -1; c <= SIZE; c++) {
                    const el = document.createElement('div');
                    if (r >= 0 && r < SIZE && c >= 0 && c < SIZE) {
                        el.className = 'cell';
                        el.onclick = () => placeObject(r, c);
                        el.id = `cell-${r}-${c}`;
                    } else if (c === SIZE && r >= 0 && r < SIZE && targets.right[r]) {
                        el.className = 'hint';
                        el.style.color = targets.right[r];
                        el.innerText = 'GOAL';
                    } else {
                        el.className = 'hint';
                    }
                    board.appendChild(el);
                }
            }
            render();
        }

        function placeObject(r, c) {
            grid[r][c] = grid[r][c] === currentTool ? null : currentTool;
            render();
        }

        function render() {
            // 모든 셀 초기화
            for(let r=0; r<SIZE; r++) {
                for(let c=0; c<SIZE; c++) {
                    const el = document.getElementById(`cell-${r}-${c}`);
                    el.innerHTML = '';
                    const obj = grid[r][c];
                    if(obj === 'R') el.innerHTML = '<div class="w-6 h-6 rounded-full bg-red-500 shadow-[0_0_15px_red]"></div>';
                    if(obj === 'G') el.innerHTML = '<div class="w-6 h-6 rounded-full bg-green-500 shadow-[0_0_15px_green]"></div>';
                    if(obj === 'B') el.innerHTML = '<div class="w-6 h-6 rounded-full bg-blue-500 shadow-[0_0_15px_blue]"></div>';
                    if(obj === 'M1') el.innerHTML = '<div class="mirror-slash"></div>';
                    if(obj === 'M2') el.innerHTML = '<div class="mirror-backslash"></div>';
                }
            }
            checkLogic();
        }

        function checkLogic() {
            // 여기에 빛의 경로 추적(Raycasting) 및 거울 반사 로직을 구현합니다.
            // 성공 시 '성공!' 알림 출력
        }

        init();
    </script>
</body>
</html>
